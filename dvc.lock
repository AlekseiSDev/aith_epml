schema: '2.0'
stages:
  train:
    cmd: ./.venv/bin/python scripts/train_model.py --params params.yaml
    deps:
    - path: data/splits/eval.csv
      hash: md5
      md5: db2fa252fb57f512814dfa8e63a29ead
      size: 11854
    - path: data/splits/train.csv
      hash: md5
      md5: bf292e3eec1ab27a1f7df938d5768cfd
      size: 54653
    - path: params.yaml
      hash: md5
      md5: ba5d7c1c590ef8cb19a7a3fd09c15d99
      size: 1235
    - path: scripts/train_model.py
      hash: md5
      md5: dd7e46b75fcbe6dae91e0e663f2bef83
      size: 6975
    - path: src/wine_quality_epml/experiments/tracking.py
      hash: md5
      md5: 706ca80f6dd3d9cf52218abc1ea57806
      size: 2076
    params:
      params.yaml:
        train:
          seed: 42
          target_col: quality
          id_col: Id
          paths:
            train: data/splits/train.csv
            eval: data/splits/eval.csv
            test: data/splits/test.csv
            model: models/exp_model.pkl
            meta: models/exp_model_meta.json
            train_eval_metrics: reports/train_eval_metrics.json
            test_metrics: reports/test_metrics.json
            predictions: reports/predictions.csv
            test_predictions: reports/test_predictions.csv
          model_type: lasso
          standardize: false
          linear:
            fit_intercept: true
          ridge:
            alpha: 10.0
          lasso:
            alpha: 0.1
          elasticnet:
            alpha: 0.01
            l1_ratio: 0.2
          svr:
            kernel: rbf
            c: 10.0
            epsilon: 0.1
            gamma: scale
          knn:
            n_neighbors: 15
            weights: distance
          rf:
            n_estimators: 1500
            max_depth: 20
            min_samples_split: 2
            random_state: 42
          extra_trees:
            n_estimators: 500
            max_depth: 12
            min_samples_split: 2
            random_state: 42
          gbr:
            n_estimators: 500
            learning_rate: 0.05
            max_depth: 3
            random_state: 42
          hgb:
            max_iter: 400
            learning_rate: 0.05
            max_depth: 6
            random_state: 42
    outs:
    - path: models/exp_model.pkl
      hash: md5
      md5: 2d8c456adbc307a6e1cd78d10139b4d8
      size: 720
    - path: models/exp_model_meta.json
      hash: md5
      md5: bad0cc1378a4c76777129ba068cfd240
      size: 577
    - path: reports/predictions.csv
      hash: md5
      md5: e5f9a296809856fbf503e301d2bd72a1
      size: 28023
    - path: reports/train_eval_metrics.json
      hash: md5
      md5: 0602f69ed838cde4f19b94cb9cdf6154
      size: 446
  test:
    cmd: ./.venv/bin/python scripts/test_trained_model.py --params params.yaml
    deps:
    - path: data/splits/test.csv
      hash: md5
      md5: 68d47bd43d77ec0348d2a8f45f25aaeb
      size: 11850
    - path: models/exp_model.pkl
      hash: md5
      md5: 2d8c456adbc307a6e1cd78d10139b4d8
      size: 720
    - path: params.yaml
      hash: md5
      md5: ba5d7c1c590ef8cb19a7a3fd09c15d99
      size: 1235
    - path: scripts/test_trained_model.py
      hash: md5
      md5: 272e7fd3fbd47b728d3d76e864db0559
      size: 2756
    params:
      params.yaml:
        train:
          seed: 42
          target_col: quality
          id_col: Id
          paths:
            train: data/splits/train.csv
            eval: data/splits/eval.csv
            test: data/splits/test.csv
            model: models/exp_model.pkl
            meta: models/exp_model_meta.json
            train_eval_metrics: reports/train_eval_metrics.json
            test_metrics: reports/test_metrics.json
            predictions: reports/predictions.csv
            test_predictions: reports/test_predictions.csv
          model_type: lasso
          standardize: false
          linear:
            fit_intercept: true
          ridge:
            alpha: 10.0
          lasso:
            alpha: 0.1
          elasticnet:
            alpha: 0.01
            l1_ratio: 0.2
          svr:
            kernel: rbf
            c: 10.0
            epsilon: 0.1
            gamma: scale
          knn:
            n_neighbors: 15
            weights: distance
          rf:
            n_estimators: 1500
            max_depth: 20
            min_samples_split: 2
            random_state: 42
          extra_trees:
            n_estimators: 500
            max_depth: 12
            min_samples_split: 2
            random_state: 42
          gbr:
            n_estimators: 500
            learning_rate: 0.05
            max_depth: 3
            random_state: 42
          hgb:
            max_iter: 400
            learning_rate: 0.05
            max_depth: 6
            random_state: 42
    outs:
    - path: reports/test_metrics.json
      hash: md5
      md5: 5ad97bb9aef013c9373055075df0f372
      size: 152
    - path: reports/test_predictions.csv
      hash: md5
      md5: 70f4cd114b2f8e360c24061bdb39db7e
      size: 4838
